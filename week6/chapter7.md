# 💾 7장 MySQL 

## 1. 데이터베이스 및 RDBMS 개요

* **데이터베이스 (Database)**: 특정 목적을 위해 관련성을 가지며 **중복이 최소화된** 데이터들의 집합입니다.
* **RDBMS (Relational Database Management System)**: 데이터를 테이블 형태로 구성하고, 테이블 간의 **관계**를 정의하여 관리하는 시스템입니다.
    * **예시**: Oracle, **MySQL**, PostgreSQL 등.
* **저장 매체**: 주로 **HDD** 또는 **SSD**에 저장됩니다.
* **동시 접속 및 권한**: 서버에 데이터베이스를 올려 여러 사용자가 동시 사용 가능하며, 사용자별로 **권한(읽기/관리 등)** 부여가 가능합니다.

---

## 2. MySQL 접속 및 기본 명령어

* **접속**: 경로에 상관없이 **명령어 입력**으로 프롬프트(CLI)에 접속 가능합니다.
* **SQL 구문 완료**: 모든 SQL 구문은 끝에 반드시 **세미콜론(`;`)**을 붙여야 문장이 완료됩니다.
* **데이터베이스 생성**:
    ```sql
    CREATE DATABASE [데이터베이스_이름];
    ```

---

## 3. 테이블(Table) 및 컬럼(Column) 구조

* **테이블**: 데이터가 들어갈 수 있는 **구조화된 틀**입니다.
* **컬럼**: 테이블의 각 항목이며, 데이터의 **규칙**에 맞지 않으면 입력이 불가합니다.

### 🔑 주요 컬럼 옵션 및 키

| 옵션/키 | 설명 |
| :--- | :--- |
| **`NOT NULL`** | 해당 컬럼에 NULL 허용 불가. |
| **`ZEROFILL`** | 숫자 자릿수를 고정하고, 빈자리에 `0`을 채움 (예: `12` $\to$ `00012`). |
| **`PRIMARY KEY`** | 레코드를 **고유하게 식별**하는 키. 자동으로 **인덱스**를 포함합니다. |
| **`UNIQUE INDEX`** | 해당 컬럼의 데이터가 **고유해야 함**을 보장합니다. |

### 🔍 테이블 관리 명령어

* **테이블 구조 확인**:
    ```sql
    DESC [테이블_이름];
    ```
* **테이블 삭제**:
    ```sql
    DROP TABLE [테이블_이름];
    ```

---

## 4. 데이터 조작어 (CRUD)

| **Create** (생성) | `INSERT` | 데이터를 테이블에 새로 삽입합니다. 여러 레코드를 `,`로 구분하여 한 번에 삽입 가능. |
| **Read** (조회) | `SELECT` | 데이터베이스의 데이터를 조회합니다. |
| **Update** (수정) | `UPDATE` | 기존 데이터를 수정합니다. |
| **Delete** (삭제) | `DELETE` | 기존 데이터를 삭제합니다. |

### 📜 주요 `SELECT` 구문

* **조건 조회**: `WHERE` 절을 사용해 특정 조건에 맞는 데이터만 찾습니다.
    * `AND` 또는 `OR`를 사용해 여러 조건을 묶어 사용 가능합니다.
    * **주의**: SQL에서는 `undefined`를 사용하지 않습니다.
* **정렬**: `ORDER BY [컬럼] ASC/DESC`로 오름차순/내림차순 정렬 가능.
* **제한 및 건너뛰기**:
    * `LIMIT [개수]`: 조회할 레코드의 최대 개수 제한.
    * `OFFSET [건너뛸_개수]`: 앞에서부터 지정된 개수만큼 건너뛰고 조회.

### ⚠️ `UPDATE`/`DELETE` 시 주의사항

* `UPDATE`나 `DELETE` 시 `WHERE` 절을 사용하지 않으면 **테이블의 모든 데이터**가 수정되거나 삭제되므로, 항상 조건(AND/OR 사용 가능)을 명확히 지정해야 합니다.

---

## 5. Node.js ORM: Sequelize 연동 및 관계 정의

**Sequelize**를 사용하여 Node.js 환경에서 MySQL을 객체 형태로 다룹니다.

### 🔌 연동 및 동기화

* **패키지 설치**: `sequelize` 패키지를 설치합니다.
* **`sequelize.sync()`**: 모델과 MySQL을 연동하여 실제 DB에 테이블을 생성합니다.
    * `{ force: false }` (기본값): 서버 실행 시 DB 테이블이 이미 존재하면 재사용합니다.
    * `{ force: true }`: 테이블이 존재해도 **삭제하고 다시 생성**합니다 (개발 초기 구조 확인용).
* **설정 파일**: `config`와 데이터베이스 정보를 **개인 설정**에 맞게 수정하여 사용합니다.

### 🤝 관계 정의

모델 간의 관계를 정의합니다.

* `hasOne`: 1:1 관계
* `hasMany`: 1:N 관계 (Has Many: "나는 여러 개를 가지고 있다")
* `belongsTo`: N:1 관계 (Belongs To: "나는 하나에 속해 있다")

### 🔍 관계를 포함한 데이터 조회

* **`include`**: 관계가 정의된 다른 모델의 데이터를 함께 조회할 때 사용합니다.
    * **예시**: 게시글 조회 시, `include`를 사용하여 해당 게시글의 댓글까지 함께 가져올 수 있습니다.

### 💡 관계를 통한 데이터 조작 (Magic Methods)

관계가 정의되면 Sequelize가 자동으로 생성하는 메서드입니다.


| **조회** | `getComments()` | 관계된 데이터를 가져옵니다. |
| **생성** | `createComment({...})` | 관계된 새로운 데이터를 생성합니다. |
| **수정/설정** | `setProfile({...})` | 관계된 데이터를 수정하거나 설정합니다. |
| **추가** | `addPost(...)` | N:M 관계에서 연결을 생성합니다. |
| **삭제** | `removePost(...)` | N:M 관계에서 연결을 삭제합니다. |

이를 통해 새로운 정보를 가져와서 **데이터 수정**이 가능하며, 배열을 가져와 **여러 개의 관계된 데이터**를 한 번에 조정하는 것도 가능합니다.